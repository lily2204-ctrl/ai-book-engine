<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Create Your Book</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;max-width:720px;margin:40px auto;padding:0 16px}
    label{display:block;margin:14px 0 6px;font-weight:600}
    input,select,textarea{width:100%;padding:12px;border:1px solid #ddd;border-radius:10px}
    button{margin-top:18px;padding:12px 16px;border:0;border-radius:12px;cursor:pointer;font-weight:700}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .card{border:1px solid #eee;border-radius:16px;padding:18px}
    .small{color:#666;font-size:13px}
    .ok{color:green;font-weight:700}
    .err{color:#b00020;font-weight:700}
  </style>
</head>
<body>
  <h1>Create your child’s book</h1>
  <p class="small">MVP wizard – sends data to your AI Book Engine.</p>

  <div class="card">
    <div class="row">
      <div>
        <label>Child name</label>
        <input id="child_name" placeholder="Noa" />
      </div>
      <div>
        <label>Age</label>
        <select id="age">
          <option value="3">3</option><option value="4">4</option><option value="5" selected>5</option>
          <option value="6">6</option><option value="7">7</option><option value="8">8</option>
        </select>
      </div>
    </div>

    <label>Story type</label>
    <select id="story_type">
      <option value="magical_forest">Magical Forest</option>
      <option value="space_mission">Space Mission</option>
      <option value="ocean_journey">Ocean Journey</option>
      <option value="bedtime_calm">Bedtime Calm</option>
      <option value="friendship">Friendship</option>
    </select>

    <label>Illustration style</label>
    <select id="illustration_style">
      <option value="watercolor">Soft Watercolor</option>
      <option value="modern_storybook">Modern Storybook</option>
      <option value="whimsical">Whimsical</option>
      <option value="minimal_scandi">Minimal Scandi</option>
    </select>

    <label>Traits (comma separated)</label>
    <input id="traits" placeholder="brave, curious" />

    <label>Reference image URLs (comma separated) – TEMP for MVP</label>
    <input id="reference_images" placeholder="https://..." />
    <p class="small">For now we use URLs. Next step we’ll add real upload.</p>

    <button id="btn">Create Book</button>

    <p id="status" class="small"></p>
  </div>

  <script>
    const API_BASE = "https://romantic-patience-production.up.railway.app";

    document.getElementById("btn").addEventListener("click", async () => {
      const statusEl = document.getElementById("status");
      statusEl.textContent = "Creating…";
      statusEl.className = "small";

      const payload = {
        child_name: document.getElementById("child_name").value.trim(),
        age: Number(document.getElementById("age").value),
        story_type: document.getElementById("story_type").value,
        illustration_style: document.getElementById("illustration_style").value,
        traits: document.getElementById("traits").value.split(",").map(s => s.trim()).filter(Boolean),
        reference_images: document.getElementById("reference_images").value.split(",").map(s => s.trim()).filter(Boolean)
      };

      try {
        const res = await fetch(`${API_BASE}/create-book`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await res.json();

        statusEl.textContent = "Success ✅ Request sent. Check console/logs for received data.";
        statusEl.className = "ok";
        console.log("Server response:", data);
      } catch (e) {
        statusEl.textContent = "Error ❌ " + (e?.message || e);
        statusEl.className = "err";
      }
    });
  </script>
</body>
</html>
