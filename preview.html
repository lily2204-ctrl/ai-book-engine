<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Book Preview</title>
<style>
body { background:#eef1ff; font-family:Arial; text-align:center; }

.book-container {
  perspective:2000px;
  margin-top:40px;
}

.book {
  width:800px;
  height:500px;
  margin:auto;
  position:relative;
}

.page {
  position:absolute;
  width:100%;
  height:100%;
  transform-origin:left;
  transition:transform .7s;
}

.page.flipped { transform:rotateY(-180deg); }

.side {
  position:absolute;
  width:100%;
  height:100%;
  border-radius:18px;
  backface-visibility:hidden;
  overflow:hidden;
}

.front { background:white; }
.back { background:white; transform:rotateY(180deg); }

.cover {
  background:linear-gradient(135deg,#ff7eb3,#6a5cff);
  color:white;
  padding:50px;
}

.paper {
  padding:40px;
  font-family:Georgia;
  line-height:1.6;
}

.page-num {
  position:absolute;
  bottom:15px;
  right:20px;
  font-size:12px;
  color:#999;
}

.shadow {
  width:70%;
  height:30px;
  margin:20px auto;
  background:rgba(0,0,0,.3);
  filter:blur(15px);
  border-radius:50%;
}

.controls { margin-top:20px; }
button { padding:10px 16px; margin:5px; border:none; border-radius:10px; cursor:pointer; }
.primary { background:#111; color:white; }
.secondary { background:#eee; }
</style>
</head>

<body>

<h2>Book Preview</h2>

<div class="book-container">
  <div id="book" class="book"></div>
  <div class="shadow"></div>
</div>

<div class="controls">
  <button class="secondary" onclick="prev()">Previous</button>
  <button class="primary" onclick="next()">Next</button>
</div>

<script>

let pages=[];
let index=0;

function buildBook(){

  const story = localStorage.getItem("bookStory");
  const title = localStorage.getItem("bookTitle");
  const photo = localStorage.getItem("childPhoto");

  const paragraphs = story.split("\n").filter(p=>p.trim()!=="");

  const book = document.getElementById("book");
  book.innerHTML="";

  // Cover
  const cover = document.createElement("div");
  cover.className="page";
  cover.innerHTML=`
    <div class="side cover front">
      <h1>${title}</h1>
      <img src="${photo}" style="width:200px;border-radius:15px;margin-top:20px;">
    </div>
    <div class="side cover back"></div>
  `;
  book.appendChild(cover);
  pages.push(cover);

  // Pages
  for(let i=0;i<paragraphs.length;i+=2){

    const page=document.createElement("div");
    page.className="page";

    page.innerHTML=`
      <div class="side front paper">
        ${paragraphs[i] || ""}
        <div class="page-num">${i+1}</div>
      </div>
      <div class="side back paper">
        ${paragraphs[i+1] || ""}
        <div class="page-num">${i+2}</div>
      </div>
    `;

    book.appendChild(page);
    pages.push(page);
  }
}

function next(){
  if(index<pages.length){
    pages[index].classList.add("flipped");
    index++;
  }
}

function prev(){
  if(index>0){
    index--;
    pages[index].classList.remove("flipped");
  }
}

buildBook();

</script>

</body>
</html>
